<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>

<link rel="stylesheet" href="../../includes/css/master.css"></link>
<link rel="stylesheet" href="../../includes/font-awesome-4.7.0/css/font-awesome.min.css"></link>

	<script type="text/javascript">
		
		PrimeFaces.locales['pt'] = {  
	            closeText: 'Fechar',  
	            prevText: 'Anterior',  
	            nextText: 'Próximo',  
	            currentText: 'Começo',  
	            monthNames: ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],  
	            monthNamesShort: ['Jan','Fev','Mar','Abr','Mai','Jun', 'Jul','Ago','Set','Out','Nov','Dez'],  
	            dayNames: ['Domingo','Segunda','Terça','Quarta','Quinta','Sexta','Sábado'],  
	            dayNamesShort: ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb'],  
	            dayNamesMin: ['D','S','T','Q','Q','S','S'],  
	            weekHeader: 'Semana',  
	            firstDay: 1,
	            isRTL: false,  
	            showMonthAfterYear: false,  
	            yearSuffix: '', 
	            timeOnlyTitle: 'Só Horas',  
	            timeText: 'Tempo',  
	            hourText: 'Hora',  
	            minuteText: 'Minuto',  
	            secondText: 'Segundo',  
	            currentText: 'Data Atual',  
	            ampm: false,  
	            month: 'Mês',  
	            week: 'Semana',  
	            day: 'Dia',  
	            allDayText : 'Todo Dia'  
	        };
	
	</script>
	
	
</h:head>
	<h:body>
		<!-- INICIO DO MODAL DO CADASTRO DE ENDEREÇO DO FUNCIONÁRIO -->
		<p:dialog header="Cadastro do Endereço" widgetVar="modalEnd" modal="true" position="top">
			
			<!-- INICIO DO FORM DO CADASTRO DE ENDEREÇO DO FUNCIONÁRIO -->
			<p:panel styleClass="ui-g-12 ui-md-12 ui-lg-12">
			<p:messages id="mensagenValidacao" closable="true"/>
			<div class="ui-g-12 ui-md-12 ui-lg-3"></div>
			<h:form id="formBuscaCepFunc">
		<h:inputHidden value="#{mbFuncionario.funcionario.idPessoa}" id="idFuncionario"></h:inputHidden>
		<p:growl id="pgrowlBuscaCep"></p:growl>
			<h:panelGrid columns="12" styleClass="ui-g-12 ui-md-12 ui-lg-6">
				<h:panelGrid columns="1">
					<h:panelGrid columns="2">
						<h:panelGrid columns="1">
							<p:inputText value="#{mbFuncionario.funcionario.endereco.cep}" 
										title="Digite um Cep e clique em Buscar CEP" 
										placeholder="Digite o CEP" id="msgCep"
										required="true" type="text" maxlength="8" 
										requiredMessage="O CPF é obrigatório"
										validatorMessage="Digite o CEP no padrão correto: (Números, máximo de 8)"
										>
										<f:validateRegex pattern="[0-9]{0,8}" for="msgCep"></f:validateRegex>
										</p:inputText>
						</h:panelGrid>
						<h:panelGrid columns="1">
							<p:commandButton value="Buscar CEP" action="#{mbFuncionario.buscarCep}" 
											ajax="true" update=":formEnderecoFunc,:formBuscaCepFunc" />
						</h:panelGrid>
					</h:panelGrid>
				</h:panelGrid>
			</h:panelGrid>
			
		</h:form>
			
			<h:form id="formEnderecoFunc">
			<p:growl id="pgrowlFormEnd"></p:growl>
				<h:inputHidden value="#{mbFuncionario.funcionario.idPessoa}" id="idPessoa"></h:inputHidden>
				<h:inputHidden value="#{mbFuncionario.funcionario.endereco.cep}"></h:inputHidden>
				<h:inputHidden value="#{mbFuncionario.funcionario.endereco.idEndereco}"></h:inputHidden>
				<h:panelGrid columns="3" >
					
					<h:panelGrid columns="1">
							Logradouro:
							<p:inputText size="50" value="#{mbFuncionario.funcionario.endereco.logradouro}" 
										title="Logradouro do funcionário" type="text" 
										placeholder="Logradouro" required="true" 
										requiredMessage="O Logradouro é obrigatório"
										maxlength="80" />
					</h:panelGrid>
					
					<h:panelGrid columns="1">
							N.º:
							<p:inputText size="7" value="#{mbFuncionario.funcionario.endereco.numero}" 
										title="Número" type="number" placeholder="N.º"
										required="true" requiredMessage="O número é obrigatório"
										validatorMessage="O campo número deve conter até 6 números">
										<f:validateLength minimum="0" maximum="6"></f:validateLength>
										</p:inputText>
					</h:panelGrid>
					<h:panelGrid columns="1">
							Complemento:
							<p:inputText size="20" value="#{mbFuncionario.funcionario.endereco.complemento}" 
										title="Didite um complemento" type="text" placeholder="Complemento"
										maxlength="30"/>
					</h:panelGrid>
				</h:panelGrid>
				<h:panelGrid columns="4" >
					<h:panelGrid columns="1">
							Bairro:
							<p:inputText size="20" value="#{mbFuncionario.funcionario.endereco.bairro}" 
										title="Digite o bairro do funcionário" type="text" placeholder="Bairro"
										maxlength="30"/>
					</h:panelGrid>
					<h:panelGrid columns="1">
							Cidade:
							<p:inputText size="25" value="#{mbFuncionario.funcionario.endereco.cidade}" 
										title="Digite a cidade do funcionário" type="text" placeholder="Cidade"
										maxlength="30"/>
					</h:panelGrid>
					
					<h:panelGrid columns="1">
							UF:
							<p:inputText size="7" value="#{mbFuncionario.funcionario.endereco.uf}" 
										title="Digite o estado do funcionário" type="text" placeholder="UF"
										maxlength="2"/>
					</h:panelGrid>
				</h:panelGrid>
			
				<p:panel>
				
				<div class="ui-g-12 ui-md-12 ui-lg-4"></div>
				
				<h:panelGrid columns="4" style="text-align:center;">
					<p:commandButton value="Cadastrar" style="display:#{mbFuncionario.styleDisplayBtnFormEnderecoCadastrar};" action="#{mbFuncionario.cadastrarEndereco}" update=":formEnderecoFunc"/>	
					<p:commandButton value="Alterar" style="display:#{mbFuncionario.styleDisplayBtnFormEnderecoAlterar};" action="#{mbFuncionario.alterarEndereco}" update=":formEnderecoFunc"/>
					
					
					<p:commandButton value="Cancelar" style="display:#{mbFuncionario.styleDisplayBtnFormEnderecoCadastrar};" onclick="PF('modalEnd').hide();" update=":formEnderecoFunc, :formBuscaCepFunc" process="@this" action="#{mbFuncionario.cancelarPreenchimentoEndereco}"/>
					<p:commandButton value="Fechar" style="display:#{mbFuncionario.styleDisplayBtnFormEnderecoAlterar};" onclick="PF('modalEnd').hide();"/>
				</h:panelGrid>
				</p:panel>
			</h:form>
			</p:panel>
			<!-- FIM DO FORM DO CADASTRO DE ENDEREÇO DO FUNCIONÁRIO -->	
		</p:dialog>
	<!-- FIM DO MODAL DO CADASTRO DE ENDEREÇO DO FUNCIONÁRIO -->
	
		<p:layout fullPage="true" styleClass="cortela">
		    <p:layoutUnit position="center" styleClass="cortela">
				
				<!-- INCLUSÃO DO MENU -->
				<ui:include src="../../includes/menu.xhtml"></ui:include>
				
				<!-- INICIO PAINEL FORM FUNCIONÁRIO -->
			<p:panel styleClass="ui-g-12 ui-md-12 ui-lg-12" header="Dados do Funcionário">
				<h:form id="formCadConsFuncionario">
				<p:growl id="pgrowFormFuncionario"></p:growl>
				<h:inputHidden value="#{mbFuncionario.funcionario.idPessoa}"></h:inputHidden>
				<h:panelGrid columns="6">
					
					<h:panelGrid columns="1">
					Nome:
						<p:inputText value="#{mbFuncionario.funcionario.nomePessoa}" title="Nome do Paciente" 
									placeholder="Nome" required="true" requiredMessage="O campo Nome é obrigatório"
									maxlength="80" type="text"/>
						<p/>
					Email:
						<p:inputText value="#{mbFuncionario.funcionario.email}" title="Email do Paciente" 
									type="text" placeholder="Email" required="true" 
									requiredMessage="O campo E-mail é obrigatório" maxlength="45" 
									/>
									
					</h:panelGrid>
					<h:panelGrid columns="1">
					CPF:
						<p:inputText value="#{mbFuncionario.funcionario.cpf}" title="CPF do Paciente" 
									maxlength="11" size="12" type="text" placeholder="CPF"
									validatorMessage="No campo CPF digite apenas números (de 0 a 11)"
									>
									<f:validateRegex pattern="[0-9][0,11]"></f:validateRegex>
									</p:inputText>
						<p/>
					Identidade:
						<p:inputText value="#{mbFuncionario.funcionario.identidade}" title="Identidade do Paciente" 
									size="12" type="text" placeholder="Identidade" maxlength="9"/>
					</h:panelGrid>
					<h:panelGrid columns="1">
					Data de Nascimento:
						<p:calendar locale="pt" mask="true"  pattern="dd/MM/yyyy" navigator="true" yearRange="c-100:c"  value="#{mbFuncionario.funcionario.dataNascimento.time}" id="dataNascimento" title="Data de Nascimento" placeholder="Data de Nascimento">
<!-- 							<f:convertDateTime  timeZone="GMT-3" type="date" pattern="dd/MM/yyyy" ></f:convertDateTime> -->
						</p:calendar>
							<p/>
					Sexo:
					        <p:selectOneRadio id="sexo" value="#{mbFuncionario.funcionario.sexo}" 
					        					label="Sexo" required="true"
					        					requiredMessage="O campo sexo é obrigatório">
					            <f:selectItem itemLabel="Masculino" itemValue="M" />
					            <f:selectItem itemLabel="Feminino" itemValue="F" />
					        </p:selectOneRadio>
					</h:panelGrid>
					
					<h:panelGrid columns="1">
					
					Telefone:
						<h:panelGrid columns="2">
								<p:inputText value="#{mbFuncionario.funcionario.ddd}" title="Digite o DDD" 
											type="text" size="3" maxlength="2" placeholder="DDD"
											validatorMessage="No campo DDD digite apenas números">
											<f:validateRegex pattern="[0-9]{0,2}"></f:validateRegex>
											</p:inputText>
								<p:inputText maxlength="8" size="10" value="#{mbFuncionario.funcionario.telefone}" 
											title="Digite o Tel" type="text" placeholder="Telefone"
											validatorMessage="No campo telefone digite apenas números">
											<f:validateRegex pattern="[0-9]{0,8}"></f:validateRegex>
											</p:inputText>
						</h:panelGrid>
					<p/>
					Celular:
						<h:panelGrid columns="2">
<!-- 								<p:inputText value="" title="Digite o DDD" type="text" size="3" maxlength="2" placeholder="DDD"/> -->
								<p:inputText value="#{mbFuncionario.funcionario.celular}" title="Digite o Cel" 
											type="text" size="10" maxlength="9" placeholder="Celular"
											validatorMessage="No campo celular digite apenas números">
											<f:validateRegex pattern="[0-9]{0,9}"></f:validateRegex>
											</p:inputText>
						</h:panelGrid>
						
					</h:panelGrid>
					<h:panelGrid columns="1" >
						Cargo:
						<p:selectOneMenu value="#{mbFuncionario.funcionario.cargo.idCargo}" required="true"
										requiredMessage="O campo cargo é obrigatório">
							<f:selectItem itemLabel="Selecione um Cargo" itemValue="" />
							<f:selectItems value="#{mbFuncionario.listaCargo}" var="cargo" itemLabel="#{cargo.nomeCargo}" itemValue="#{cargo.idCargo}"></f:selectItems>
						</p:selectOneMenu>
						<p/>
						Senha:
	        			<p:password id="nonFeedback" value="#{mbFuncionario.funcionario.usuario.senha}" 
	        						required="true" requiredMessage="O campo senha é obrigatório"
	        						maxlength="45"/>
					</h:panelGrid>
					<h:panelGrid columns="1" border="3" >
						<p:commandButton style="width:200px;" rendered="#{mbFuncionario.funcionario.idPessoa == null}" value="Adicionar Endereço" disabled="true" type="button" onclick="PF('modalEnd').show();"/>
						<p:commandButton style="width:200px;" rendered="#{mbFuncionario.funcionario.idPessoa != null and mbFuncionario.funcionario.endereco.idEndereco == null}" value="#{mbFuncionario.labelBtnModalEnd}" disabled="false" type="button" onclick="PF('modalEnd').show();"/>
						<p:commandButton style="width:200px;" rendered="#{mbFuncionario.funcionario.idPessoa != null and mbFuncionario.funcionario.endereco.idEndereco != null}" value="#{mbFuncionario.labelBtnModalEnd}" disabled="false" type="button" onclick="PF('modalEnd').show();"/>
					</h:panelGrid>
				</h:panelGrid>
				
				<div class="ui-g-12 ui-md-12 ui-lg-5"></div>
				<h:panelGrid columns="3">
					<p:commandButton  value="Salvar" style="display:#{mbFuncionario.styleDisplayBtnFormFuncionarioCadastrar};" action="#{mbFuncionario.cadastrarFuncionario}" update=":formCadConsFuncionario, :formEnderecoFunc, :formBuscaCepFunc, :formTabelaFuncionario" />

					<p:commandButton  value="Alterar" style="display:#{mbFuncionario.styleDisplayBtnFormFuncionarioAlterar};" action="#{mbFuncionario.alterarFuncionario}" update=":formCadConsFuncionario, :formTabelaFuncionario" />
					<p:button  value="Cancelar" href="../../index.jsf" />
				</h:panelGrid>	
			</h:form>
			</p:panel>
			<!-- FIM PAINEL FORM FUNCIONÁRIOS -->
			
			
			<!-- INICIO PAINEL TABELA LISTA DE FUNCIONÁRIOS-->
			<p:panel styleClass="ui-g-12 ui-md-12 ui-lg-12 cortela">
				<h:form id="formTabelaFuncionario">
				<p:growl id="pgrowFormTabelaFunc"></p:growl>
					<p:dataTable id="tbl" var="funcionario" value="#{mbFuncionario.listaFuncionario}" 
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						paginator="true" rows="10" style="margin-bottom:20px" emptyMessage="Não possui funcionários cadastrados">
						<f:facet name="{Exporters}">
							<h:commandLink>
								<p:graphicImage value="/img/excel.png" width="24px"/>
								<p:dataExporter type="xls" target="tbl" fileName="Lista_Funcionarios" />
							</h:commandLink>

							<h:commandLink>
								<p:graphicImage value="img/pdf.png" width="24px"/>
								<p:dataExporter type="pdf" target="tbl" fileName="Lista_Funcionarios" />
							</h:commandLink>
						</f:facet>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Funcionário" />
							</f:facet>
							<h:outputText value="#{funcionario.nomePessoa}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Cargo" />
							</f:facet>
							<h:outputText value="#{funcionario.cargo.nomeCargo}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="E-mail" />
							</f:facet>
							<h:outputText value="#{funcionario.email}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Telefone" />
							</f:facet>
							<h:outputText value="(#{funcionario.ddd}) #{funcionario.telefone} / #{funcionario.celular}" />
						</p:column>

						<p:column style="text-align:center;" exportable="false">
							<f:facet name="header">
								<h:outputText value="Ação" />
							</f:facet>
						<h:inputHidden value="#{funcionario.idPessoa}"></h:inputHidden>
							<p:commandButton icon="fa fa-pencil" action="#{mbFuncionario.cosultarFuncionario}" title="Cliquei aqui para Editar" update=":formCadConsFuncionario, :formEnderecoFunc, :formBuscaCepFunc">
								<f:setPropertyActionListener value="#{funcionario.idPessoa}" target="#{mbFuncionario.funcionario.idPessoa}"></f:setPropertyActionListener>
								<f:setPropertyActionListener value="#{funcionario.idPessoa}" target="#{mbFuncionario.funcionario.usuario.idUsuario}"></f:setPropertyActionListener>
							</p:commandButton>
							<p:commandButton icon="fa fa-trash" action="#{mbFuncionario.deleterFuncionario}" title="Cliquei aqui para Excluir" update=":formTabelaFuncionario">
								<f:setPropertyActionListener value="#{funcionario.idPessoa}" target="#{mbFuncionario.funcionario.idPessoa}"></f:setPropertyActionListener>
								<f:setPropertyActionListener value="#{funcionario.idPessoa}" target="#{mbFuncionario.funcionario.endereco.idEndereco}"></f:setPropertyActionListener>
								<f:setPropertyActionListener value="#{funcionario.idPessoa}" target="#{mbFuncionario.funcionario.usuario.idUsuario}"></f:setPropertyActionListener>
							</p:commandButton>
						</p:column>
					</p:dataTable>

				</h:form>
					
			</p:panel>
			
		</p:layoutUnit>
		<p:layoutUnit position="south" footer="&copy; Copyright todos os direitos reservados - Gilson Santos e Mario Glaucon - Sistema de Controle Odontológico" styleClass="cortela"></p:layoutUnit>
		
		</p:layout>
	</h:body>
</html>